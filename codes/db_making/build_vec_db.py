from chromadb import PersistentClient
from chromadb.utils import embedding_functions
import hashlib
import numpy as np
from datetime import datetime, timedelta
from TEU import TextExtractionUnit
import torch
from get_vec import get_vec
from tqdm import tqdm
import time

n_days = 15
stock_name = 'HSI'


def sha256_str(str_in: str) -> str:
    return hashlib.md5(str_in.encode('utf-8')).hexdigest()


def load_pickle_dict(news_dict_pickle_path):
    import pickle
    with open(news_dict_pickle_path, "rb") as f:
        news_dict_: dict = pickle.load(f)
        # print('news_dict_len >>> ', len(news_dict_.keys()))
    return news_dict_


news_dict = load_pickle_dict('../../datas/news_dict.pickle')
vol_dict = load_pickle_dict('../../stock_fetching/vol_dict.pickle')
embedding_model_path = '../../moka-ai/m3e-large'

client = PersistentClient(path='./dbs/n_days_15')
embedding_function = embedding_functions.SentenceTransformerEmbeddingFunction(
    model_name=embedding_model_path)

# client.reset()
collection = client.get_or_create_collection(name="default",
                                             embedding_function=embedding_function, )

device = 'cuda' if torch.cuda.is_available() else 'cpu'

teu = TextExtractionUnit(embedding_model_path, dim_input=1024, dim_output=1024, dropout=0.1, pooling_mode='avg',
                         identity_layer=False).to(device)

news_dict = load_pickle_dict('../../datas/news_dict.pickle')
vol_dict = load_pickle_dict('../../stock_fetching/vol_dict.pickle')

embeddings = []
metadatas = []
texts = []
start_time = time.time()

counter = 0
n_debug = 0

for date in tqdm(news_dict.keys()):
    # if counter >= n_debug:
    #     break
    embedding, metadata = get_vec(date, vol_dict, news_dict, n_days, teu, device)
    if embedding is None:
        continue
    else:
        first_text = news_dict[date][0]
        embedding = embedding.detach().tolist()
        # embeddings.append(embedding.detach().tolist())
        # metadatas.append(metadata)
        # texts.append(first_text)
        # print(embedding.detach().tolist(), metadata)
    counter += 1

    print('----')
    print(embedding)
    print(first_text)
    print(metadata)
    collection.upsert(
        documents=[first_text],
        embeddings=[embedding],
        metadatas=[metadata],
        ids=[sha256_str(first_text)]
    )
# texts_pick_first = [text[0] for text in texts]
query_emb = [0.2612524798330945, 0.10884462630474302, -0.7778239914916039, -0.021424888330998676, 0.25243891902170185, 0.393451008789266, 0.20113791892006014, -0.2664492455010155, 0.31117526194964984, 0.10834894583713249, 0.3240102638043428, 0.18332685102020008, 0.021659016218844314, 0.25345184801576626, -0.12502712215702452, 0.032402464234182374, 0.03676036960593803, -0.4572102281006784, 0.198073767002102, -0.2821686678927557, -0.23465457031834533, 0.09889644881649605, 0.1768412704267753, 0.8610949639350248, -0.21444100141332928, 0.7736740622738918, -0.23070118066156575, -0.05610237579145339, -0.39881873389513856, 0.16728540585635607, -0.20007777441113078, 0.2436807447662482, -0.0031999427574876463, 0.03226262002179745, 0.06144357015800837, 0.5447955013479965, -0.181902409314791, -0.38347532975999965, 1.1536440733909932, 0.4435933686747946, -0.1995052723458236, -0.08534845382084866, 0.4684133994848171, 0.03319255530731351, -0.18072662777918297, 0.26355852240228783, 0.09441986845792313, 0.21688668747326037, 0.6991546577620031, 0.36480542348710704, 0.7768548154287649, -0.1133957970925607, -0.2689232875710867, -0.1713474174365513, -0.29972083120998316, 0.3849558887845185, -0.20567924485812072, 0.060772966843931145, -0.22149564357466456, 0.5808912613797961, -0.29159989722789126, -0.3592157323790456, 0.1329984392794771, -0.07059771661902668, 0.04404803381826409, -0.2718319722690884, -0.12017406212191109, -0.2653881310103135, 0.03041712230618584, 0.38050958084276537, 0.004723334916766474, -0.19506634035604098, 0.12612467606622274, -0.21305564235119845, 0.08078742609532062, -0.47327162983506954, 0.37431922839450815, -0.1204613462972076, -0.1916061618779044, -0.5205011123031207, 0.2648518730064189, 0.7447963857429879, -0.37921757887218155, 0.08113132291745068, 0.05217606723090222, -0.38812605530502964, 0.38026274605014326, -0.95149921176311, -0.18644542661937805, 0.10974785331689148, -0.0763347976923974, 0.517021232415596, 0.35819903374613643, -0.3514485613197759, 0.36741034874958206, -0.29225039453433893, 0.38951798334070015, -0.266210124112065, -0.19684140688035903, -0.25554291434220694, -0.0743934417550727, 0.6483305857774264, -0.12330010100802231, -0.03959603546938936, -0.539210928320913, 0.2886729061965202, 0.08188378303666323, 0.5710776572955345, 0.33060170794383104, 0.18166302644103624, 0.2851800372672959, 0.31912920543171674, 0.13445904056088787, -0.344253467272848, -0.2533346712910076, -0.13657847468835624, -0.12327463324338235, 9.509303446675332e-06, -0.4349372997841509, -0.04228285109159287, -0.12061420667289277, 0.04890016851547889, 0.18293159751367438, -0.1753976707588153, -0.062303051389912704, 0.6192276009055294, -0.2221892990941567, -0.19205089302950132, -0.6238255226975992, -0.11934875715719907, 0.2601023824087185, 0.3023032941492672, 0.42704109054324124, -0.13555016944988257, 0.355148945098835, -0.6108531942969482, -0.23849125530612353, 0.8757394918991088, -0.11277843186146441, 0.29431019311561823, -0.2100810980743143, -0.4284534821271018, -0.20527712307203316, -0.5764221166322102, -0.444640847515064, -0.3195551213959603, 0.17664943941098188, 0.08552355396430383, 0.3726064286126911, 0.07256174685425158, 0.17971188703452806, 0.11526478850639876, 0.22015588274463446, -0.42382716262709463, -0.30511711097450367, -0.42261922597340196, -0.6425055264906737, -0.10135928749052983, -0.6004093380848187, -0.36018979684506286, 0.36127474556694783, -0.29871572321998796, -0.3884752024454846, 0.41479923484385517, -0.1859466926049163, 0.020349520171982365, -0.09172220094735173, 0.5991813016403534, -0.06204109706859414, 0.018919771815864347, 0.10699507804350789, -0.17007651184754724, 0.05503913611278578, -0.4978258018830898, 0.7851839808346133, 0.7108808763937577, 0.10522289555100073, -0.10029926108678891, 0.4727784943029042, 0.8509477531366698, 0.08681581083422091, 0.02081662980384711, -0.25583730965406143, -0.04721186327935377, -0.06551608415662644, -0.06943777494346139, 0.4993371282864264, 0.04755095273349118, 0.3616435063800066, -0.4438806286643086, 0.10806841593839107, 0.2248810102652592, 0.2734444778240304, -0.5912592907527121, -0.5993270937167156, -0.01828538302125296, -0.3278359897820211, 0.07295395904308899, -0.03847975066512735, 0.054327762536625385, -0.20000531626827822, -0.6124875379227175, 0.6462062146188348, 0.11848165883794688, 0.3968443701995018, -0.4254772377901955, -0.4941804480340162, 0.26637833791818644, -0.27251372970347854, -0.6213433335981405, 0.2680786518318342, -0.47903831014361437, -0.4525923891225813, 0.03928373315324326, -0.15073793847229522, 0.18136704462241607, -0.1773048828195909, 0.1330634090969764, -0.009900563444777175, 0.3558497776342961, -0.29136981266970347, 0.30782417229012854, -0.11412429963567816, 0.4262817261155054, -0.2762681032914438, -0.05661126809007663, 0.3088690982218253, 0.29168750072109995, 0.36044026835947557, 0.44656511619994715, -0.018997732870863364, 0.2874775369282196, -0.09264183434683852, -0.26572194377066755, 0.3853864908086597, 0.23001647323086938, 0.494258856133726, -0.006901074934397622, -0.15762966858328858, -0.3653868616328362, -0.1611521120368646, 0.1783149627735688, 0.005675830745344682, 0.517442374440527, -0.17446645486820167, 0.06760453830359434, 0.027379095770496104, 0.24458101916802977, -0.6539362145894874, -0.4932047107215176, -0.17232125441080387, 0.10118139311849253, 0.3800596783699157, -0.45831808569056187, -0.119699658372331, -0.026546922601473046, 0.23299104490391032, -0.3199427475629914, 0.5799742676870014, 0.15509123865667293, -0.13489662262312507, 0.07757823001670952, 0.24152386845946852, 0.0307140845842594, 0.35945817650063444, -0.04379039371828879, 0.12846647090247396, -0.47761669119210115, -0.3056732255600312, -0.12871068897969348, 0.2329569961293895, 0.2069371583560597, 0.29785863352491604, 0.3753034748448364, 0.21997074135343758, 0.1329736252872752, -0.684762165074418, 0.03298588222610531, -0.009418059406686483, 0.35156798667601563, 0.18681927914032792, 0.6389671879579577, -0.45957029651521464, 0.5037617848781965, 0.043464844968771656, -0.38505333436744926, -0.06432983054265576, 0.2599970414854015, -0.408340849433145, -0.48076716283362964, 0.475933607582504, -0.07740234034301464, 0.0058127907366509884, -0.06400485716763886, 0.22887761515308708, 0.5157113543488707, 0.1048558080946811, -0.6354881962887228, 0.1846557728872313, -0.5482630578791711, -0.26504235999486947, -0.0018908282625695496, 0.011193168645137832, -0.6995081337680514, -0.04430570461131516, 0.157197283465429, 0.6490298326254945, -0.255469425628785, -0.3443258720811577, -0.11845796938227851, -0.28409274478215635, 1.3300357188610437, -0.38009046195151974, -0.19867354252875952, -0.12895340476178174, -0.5940712240403581, 0.09376903825073764, -0.5725655496833381, -0.21433319503087442, 0.1933211766968215, 0.3449033234065459, -0.0060023636456904665, 0.06747037065810872, -0.2914128638061655, 0.41215002930866096, 0.048358482791741667, -0.36558006936989, -0.8848574931312337, -0.16291856895225254, -0.4421362715856001, -0.44234119340501005, -0.7735813794981247, -0.026700052760570286, -0.20088511105552115, 0.13219416442786894, -0.23725452227749755, -0.24577394187582519, 0.4778891858011305, 0.10692546590096286, 0.02354213698497307, 0.1472787576369821, 0.7045868692217487, -0.3816942651302258, 0.018061836621737375, 0.14103058237129706, -0.1299387189755783, 0.406344426642285, 0.8471902859199353, 0.03725070435969142, 0.5585154488002009, -0.2410670352011957, 0.0683867062934667, 0.1176892494316008, 0.7370136697382965, -0.017669586577690445, -0.1414280200816382, 0.4465248280906234, 0.14375589717538023, 0.2389250948476737, -0.22577314100176887, 0.15759730347057313, -0.28572873561581047, 0.7310255529180485, -0.16860572278465255, 0.0886283618469543, 0.19309408760216693, 0.7809456180282579, -0.46368349002668735, -0.31034534673878156, -0.43828193079484007, 0.017729138902643694, 0.4334693479713353, 0.25144145464724665, 0.37133870240148603, 0.1347750233579828, 0.36546733095958966, 0.12392287447482107, -0.389286612687249, -0.3603462450744295, -0.27663760437315166, 0.4211819928793053, -0.1527003921783776, 0.5981671699899461, -0.19120538866305947, -0.06491597204903031, 0.08726404521026818, 0.5206149381936886, 0.5603653330332532, -0.7527379403845949, -0.09719682881115521, -0.8507048782138755, 0.14317553635462937, -0.46793788290689037, 0.6379263161802307, 0.5187319539770088, -0.14205466630590974, 0.36830322020601003, 0.3750587126544432, -0.012912274968888708, -0.2415572538370082, 0.08316938863476832, 0.0576849087035661, 0.3630543718435081, 0.11088799807436994, 0.229484461504737, -0.10237201621215389, -0.3737078308527423, 0.16941938855964098, -0.021525981292497783, 0.2065533267654765, -0.7101852204475665, 0.33114804077403837, -0.5353936812599361, -0.028665172410119025, -0.05699810611114187, -0.41115914835089695, -0.17649377890568096, 0.15773551757514254, 0.34296303252804433, -0.12430721944142115, 0.735383730163375, -0.5470555586160113, -0.3977141931273709, -0.20418566672429345, -0.352524896034765, -0.2751769515506729, -0.7451294569596134, -0.32790765067005323, 0.40164320330705416, -0.5645708452162629, 0.3901104446228338, 0.4251160123535609, 0.28671506561875515, -0.5119853003175759, -0.10844286779452961, -0.43688948708769504, -0.20767064945664412, 0.0566187423067156, 0.08450649681375161, -0.049164550417725064, 0.32994516473215146, -0.23500873855178406, -0.19446524599743376, -0.11128797818369009, -0.507344017811172, -0.4259062806940289, 1.1300673375153782, -0.19886808132895611, 0.017444310862515015, -0.0059533003017655794, -0.3631396748501562, 0.19946173096576442, -0.023171583259966474, 0.028208623591521258, 0.033151101896870046, 0.4323273905479488, 0.33184167880403415, 0.518109884227411, 0.038289282773829536, -0.23873510518919835, -0.3988596917338326, 0.05226322841143353, -0.2339983923600216, 0.6898753963969613, 0.2119112967367084, -0.8379769669177797, -0.004378150901485446, 0.2255302503650296, -0.13037977458369351, -0.16342676641057158, -0.39777803290222474, -0.08109003410800633, 0.3717621962783165, -0.7132578805798727, 0.3569948615105229, 0.20600571130187934, -0.04394495013110479, 0.3305458103934287, 0.12206054000754973, -0.03844899527404863, -0.7439396586917569, 0.008660894334186701, 0.32739854703203464, -0.2673330250616412, 0.2868542002312183, -0.17099905550812552, 0.14344295041546912, 0.21958406115209986, 0.09170818241980577, -0.39084371855556765, 0.1723229081724975, 0.5195899505468187, 0.5783806944436277, 0.02652724128745263, -0.23633064895116973, -0.7829558325000032, 0.07859005176215578, -0.3832741843242045, 0.4046464745638512, 0.3174256223785016, -0.4093433319566922, 0.41076337902053006, -0.17653272530302913, -0.34896307913968777, 0.16013256070077198, -0.4725442410980726, 0.06288373101970347, 0.12594651896845527, 0.3831802981915763, 0.29790981051767335, -0.06152599587585505, 0.3688541666001167, -0.5217178033632588, -0.03388104947485454, 0.3793398783502373, 0.14628078233563807, 0.007190624721090624, 0.2455436957250197, -0.42347075805954115, -0.16522086079128145, -0.5544152978514101, -0.6289722058534076, -0.14756327241474493, 0.050327063970261765, -0.6692598063124078, -0.3651784509588559, -0.3171127924962636, -0.5855639208845996, -0.4177701347271635, -0.008877999919962177, -0.30854110734454165, 0.4533758077154732, -0.6074689184186299, 0.41286278973885476, 0.19905577397800725, -0.054816135240920355, -0.3261244219797068, 0.18194503551275468, -0.6888568894971882, -0.2334284460306882, -0.026122599923698885, 0.7007888188083684, -0.23337189508215506, -0.1238252669657483, 0.6629334506015601, -0.004234986735249382, 0.028515970955766946, 0.2792709380521034, -0.27930543755802584, -0.3317348873126097, 0.8105626163647961, 0.5120790046659781, 0.32296444239269667, -0.01953538191772736, 0.5119580816572749, 0.27566270369418056, -0.44324433965406596, -0.09287700178139827, -0.11930721740898244, 0.05260572706650444, -0.07453520243084348, -0.5340750303274967, 0.06373950366650817, -0.07255921468444285, 0.306354587070197, -0.538117404421141, 0.24232002064805397, 0.5819970107129502, -0.24602727429806948, 0.07811675467131993, -0.05055022028664174, -0.20622367811890663, 0.4556881858847892, -0.3711954644046811, 0.6451838918402699, -0.5558670045060428, 0.050778074307697624, 0.2863760150401277, 0.28751807162436555, -0.11415324907172517, 0.1632542024924526, -0.016507615098645127, -0.5543447507942355, -0.11091244077360306, 0.63620725282855, -0.6599029770010119, -0.18731150131238705, -0.27821716448525097, 0.0020177142667675563, -0.5695876163861735, 0.16048439836629783, 0.22459825224885616, -1.3098365636451796, -0.3392649748564004, 0.3064035092338687, -0.3639944321436933, 0.16939299836232316, 0.35225956451377893, 0.03887849679880403, 0.3915012096022685, -0.26670533159926635, -1.0988340931821154, -0.1664644806274254, 0.39343987414043596, -0.5439882489170356, 0.34587501615514876, -0.19026610414826373, -0.02478607334868123, 0.11378181118003285, -0.6792903252197798, -0.27853896951502133, 0.11920876591420639, 0.2801604073180406, 0.5252005100672925, -0.24530854590377266, 0.08190411523023902, -0.2968269633454528, -0.43924567993043623, -0.3098977749376116, -0.33698202767483554, 0.3246687179547552, 0.47087827675962096, -1.0654435557067878, 0.6135186545211657, 0.23998516290991273, -0.09383619403647411, -0.294581818124359, -0.07268166286685948, -1.0239430230106996, -0.13848942685341373, 0.325191542049241, -0.17676597042403586, 0.18808084163042163, -0.25354628317153793, -0.4295879989915945, 0.17071478086140401, 1.0968917217427836, -0.42015759417864307, -0.5894924492234798, 0.6790258119422186, 0.4139671741703004, -0.03035100566061901, -0.12169392554299413, 0.7211682813897352, -0.5211940810630509, 0.19320681285520336, -0.18893642031482072, -0.04609174901573241, 0.37923335997601504, 0.0016613555801151085, -0.14318027102734732, -0.24641789796260855, -0.24189122076486821, 0.5946307754912411, -0.013393661650109412, 0.08033778376129071, -0.8715126149451861, 0.07917555974904497, -0.012609867168169912, 0.8479971353491306, 0.48528425686404847, -0.5582084971822586, 0.12445454435872078, 0.0981645065841048, 0.3814252453600401, -0.20688144221200266, 0.21679899690003895, -0.6875138543108392, 0.13138922045492868, 0.13311869043670155, -0.3462169109442622, 0.21036749775175628, 0.4042956173882851, 0.1300405772927913, -0.5358938669754321, 0.19422593160098126, 0.5422941615256139, 0.7209509022350059, -0.47462231341525324, -0.1043648954684491, -0.048624678993410636, 0.2088854725729002, 0.5496866733464958, 0.2522869370947576, 0.5344383934321371, 0.9119361825951718, -0.24154986543820972, 0.15839033549189518, -0.3169892510071671, -0.26430954548183555, -0.05005239537797544, 0.2765797345158595, -0.5301330669080049, 0.04954544598546819, -0.19474844388939058, 0.2174435043898529, 0.3330976488214176, -0.10451223724909126, 0.05646788927969087, -0.053047394781980894, 0.009676496749065157, 0.479791149899485, -0.11675779265458822, -0.4760568180422695, 0.04769999274702399, -0.15674596823556797, -0.24979686015145536, 0.25222904066297364, 0.727617597930599, 0.6381186475001265, 0.061026557109095554, 0.5888115020136102, -0.5766861233814229, -0.6288483916121306, -0.19899990182410127, 0.4375075843865532, 0.26157947479889454, -0.5572697897693187, 0.11871578473231395, 0.2293732677450907, 0.19149317248838096, -0.11109080624318536, 0.011339886642613053, -0.26027240031826726, -0.0031776259406330973, -0.16459687347755844, -0.1672233633090131, -0.2196447174111668, -0.8024751974574972, 0.10599034831346277, -0.5862553407414829, 0.5744399615430443, -0.14863236029762922, 0.19746394401968048, -0.23205998071940753, -0.23264199941883107, 0.15683401109882555, 0.23458587441956733, -0.14485398975956998, -0.10932026212885179, -0.021789246477037623, -0.15605305154113952, -0.2399033071760816, -0.07558496420879296, 0.2112897191937803, 0.22895932447933054, 0.250619132529724, 0.49220072239627644, -0.032840287328449, 0.5659840065473736, 0.27774596877469176, 0.018096612732052243, 0.22639173671075108, -0.09020848075324553, -0.2958610440102514, 0.1762089677293142, 0.20933359777608013, -0.29013785246532753, 0.011421894033156264, -0.2765171111058647, -0.059492553863149424, -0.012838411702664188, -0.49749695437021957, 0.2892602295203684, 0.40348784610745647, 0.1394382562770784, -0.0356835969500622, 0.29750347184237436, -0.16358451831282722, 0.12239903842574487, -0.2986019207614715, 0.2207417977598603, -0.2974732495975092, -0.4843443074078636, 0.12232342604135671, 0.5361349203385718, 0.09926921383297635, -0.10940419710058377, -0.24989574158196376, -0.25545836100176134, -0.4663160914587492, 0.027204952286716072, 0.5175180924084042, -0.2719184927928264, 0.756889855407368, -0.31108441900154465, 0.025856517766304474, 0.19433361205818397, 0.6216496625545638, 0.13126868628106367, 0.32517963902479896, 0.1137807335292751, 0.1350247011444528, 0.0424760945475955, -0.30605111830233417, 0.30041681677447374, 0.05906680869357418, -0.1361333985236367, 0.32203447351540343, -0.6649521577910656, 0.3733775460420971, 0.09813816660482559, -0.16584149754057786, -0.36273287982202657, 0.1941769866660339, -0.449504932361771, 0.07453019527112757, 0.2145052173344451, 0.3351710620999104, 0.32440335670275067, -0.2563120770274138, -0.19967995275139122, 0.11073823907594503, 0.8368785119110014, -0.2241101344299619, 0.34387554403958986, -0.022721050715506574, -0.057060221176698324, -0.3500449786622638, -0.10804524355820593, -0.11041510190738703, 0.4263336911605869, 0.02740954540492327, 0.25514811225316714, -0.4669193968713991, -0.3395991026307735, 0.06402641497844273, 0.6428154706192013, 0.09060552979182246, -0.20487855322792492, 0.013402447558528575, -0.26805598689680105, -0.3480540939217031, -0.2922894549538975, 0.15994468622501762, 0.39974243584731184, 0.2625226676189434, 0.028992512919094222, -0.0776343656913127, 0.46638689411702045, 0.09425255732234086, 0.13082397907590732, 0.03513232754278019, 0.7264576535403177, 0.32771743939984954, 0.26706590885387393, -0.03016054587037427, 0.04178965180431197, 0.4285067304193705, -0.475030107255609, 0.27446641479654543, 0.008436603032757003, -0.48193734559804446, -0.21009838476336617, -0.37751811945688, 0.4498242931886286, 0.4234099970554649, -0.08242050340181593, -0.29755186601406564, -0.19121974724615723, 0.3554686121831139, -0.9513869086545871, -0.28587042875686597, -0.3266300327671548, -0.17468293410852156, 0.21145389100876835, -0.056955612808794076, 0.5270800107178538, -0.8353346112798218, 0.13934039343127208, -0.15695717586473945, -0.2746068455737366, -0.8142070319778505, 0.15486235100916199, -0.06818372602677387, -0.27955989675080034, -0.022084008453924955, -0.18057079865533987, -0.6665906819329029, 0.6195976320069853, -0.355935200347105, 0.7026901142997638, 0.0054204751740020325, 0.44524013711655386, -0.20176259568938273, -0.3440954765689586, 0.2055820776812337, -0.028772112185408517, 0.47281860043183616, 0.5468917158289757, 0.268404722435177, 0.08149075515129808, 0.1305221022609936, -0.3678784974731324, 0.2654087810953633, 0.2178318967047724, -0.10209219755969312, 0.07452265639859562, 0.07138036010044325, -0.3955625211542448, -0.028122176167562324, -0.39327521038739127, 0.39912758411077, 0.48996705680537916, 0.0803224597208716, -0.00023301668412230303, -0.3359573057631054, 0.19570803627093972, 0.0736750940798521, 0.22358845592116447, -0.41974845304678304, -0.3085028401301405, 0.24164453502563163, -0.10238317670304617, 0.6592228090140865, 0.7743236056276898, -0.1664331460896089, -0.1870068988103883, 0.2332048515124873, 0.6648509066897534, 0.6190315039230164, -0.3021301148489164, -0.24853213148505174, 0.03207400890508806, 0.34547885508803267, 0.3964394618131774, 0.5417334504311422, -0.4341301896488382, -0.3534276158140571, 0.4499536408508337, 0.14134764533687352, -0.6676792024947594, -0.09420121987961295, 0.08860404127584875, 0.3731531539749125, -0.137014355096236, -0.050037867751127646, 0.16011677530831003, 0.4873640579308157, -0.5547506800079207, 0.03961004806089564, -0.36528399181190657, 0.4176216776185582, 0.028564124728857977, -0.4123242461771601, -0.3172165925942008, 0.039683558212455346, 0.504961543694848, 0.18715080557178998, -0.33545994486434305, -0.16725755712726764, 0.0011857591847927104, -0.3241389139622057, 0.10351099597434796, 0.00430730190399823, -0.40084392282621173, -0.014623469609242282, 0.5873520202955468, 0.10218629379861464, -0.4885416846591125, 0.16836778723374177, -0.7316170358393123, 0.40220126413769736, -0.14559023225983578, -0.4454169249847206, 0.18936626491226127, 0.07596964916195928, -0.35653061977196004, 0.799354471638938, 0.088225305222471, 0.3118155133908353, -0.3821523628733614, -0.5160904788015185, -0.6874806789611901, -0.08446011259722797, -0.2280096336773459, -0.4988795224438518, 0.7167453818535798, 0.12103719557700163, -0.30677444085500555, 0.38626808138772484, 0.3439711569824757, -0.2594812831445851, 0.03411807701383176, 0.2108033584485594, -0.46538903618372673, -0.461618622398018, -0.3268607121252617, 0.334747829622825, 0.05040885701453614, -0.5811421991734271, -0.45150710881080414, -0.3156935602767976, 0.543528089559106, 0.5169374027926741, 0.13211748949909002, -0.38343874395401256, -0.15566863682273707, 0.4860963344896021, 0.38993886727536375, -0.43196232489611663, -0.3980463501819764, 0.4379327877903833, -0.08607179661705017, -0.3744145730577555, 0.17783247575446837, 0.2811283026983383, 0.21826523393163744, 0.614923040184006, 0.1417003394309665, -0.4556799073931953, -0.30010422073971255, -0.16474085888782283, -0.07943513201244573, 0.14689294300192052, -0.4461340052838252, 0.15699825138284304, -0.5378893602400289, -0.216181235160892, 0.23020019243982973, -0.45045689623351215, -0.2698253970809458, 0.3903747452079346, 0.5473240449072408]

print(collection.query(query_embeddings=[query_emb])['documents'])
quit()
