import chromadb
from chromadb import PersistentClient
import hashlib
from chromadb.utils import embedding_functions
def sha256_str(str_in: str) -> str:
    return hashlib.md5(str_in.encode('utf-8')).hexdigest()

texts = [['n', 'd'], ['2','12']]
embeddings = [[0.12741093989930052, 0.04368141406639103, 0.04728544287509258, 0.00783440696577894],
              [0.09065868850152639, 0.047593002940173934, 0.045641835658317656, 0.02903150985975546]]
metadata = [{'change_percentage': 0.15651560170259468, 'start_date': '2024-03-12'},
            {'change_percentage': 0.008785890713192603, 'start_date': '2024-03-11'}]
embedding_model_path = '../../moka-ai/m3e-large'
client = PersistentClient(path='test2/test2')
embedding_function = embedding_functions.SentenceTransformerEmbeddingFunction(
    model_name=embedding_model_path)

collection = client.get_or_create_collection(name="a_nice__collection",
                                             embedding_function=embedding_function)
collection.upsert(
    documents=[text[0] for text in texts],
    embeddings=embeddings,
    metadatas=metadata,
    ids=[sha256_str(text[0]) for text in texts]
)

query_emb = [0.2184745119450358, 0.27940252782086916, 0.01647134042801609, 0.0013879340057629875, -0.022644879884477637, 0.0532046144002401, -0.045474660884297385, 0.10336242031660664, 0.28413486997650467, 0.3428905847501562, 0.06681067777733991, 0.04223167888629862, 0.25326353629571574, 0.09652323179430802, 0.000512886990650439, -0.017206449932477653, 0.22269185588637738, 0.03094451030704975, 0.13854180792067622, -0.03773951766138811, 0.06374210459611941, 0.0775599917790672, 0.31684285369030674, 0.10256387646181164, 0.042282047510189553, 0.026200601427226838, -0.06028545845169842, 0.09050532715757177, 0.08482464451516648, -0.05733827181203219, 0.13332447393779223, -0.05615208233419918, 0.08748492178038014, 0.02063430267995488, -0.12664443021494787, 0.17642590831622132, -0.04348218690640843, -0.06075867544949595, 0.13594981760120237, 0.183656529136831, 0.06888447596971155, -0.04148490462428905, 0.030785759091487425, -0.011021358965403, 0.07325416849657672, -0.000979704469138198, 0.1356367423976072, 0.028760870432450965, 0.11975484592998792, 0.06642722580140219, 0.1197551765673343, 0.1426559610007227, 0.31442576133374567, 0.15035943940780494, 0.027510222174389566, 0.0265384796228257, 0.05973530822083596, -0.018274386184248474, 0.06045197588628303, 0.06590244993310193, 0.0194274096529812, 0.05742257086003192, 0.0006949744745640026, -0.035107229035764416, -0.05509391482181998, 0.2904492900481765, 0.1627640989828318, 0.17014252844852068, -0.05506082590500268, 0.09268702288309366, 0.11454143874934344, 0.1858462523133546, 0.02960235732620381, 0.07292473126579395, -0.06338683091293161, 0.01342194091015712, 0.06759320915833694, 0.12205451322882159, 0.0038595893276478985, 0.13460941008099575, 0.03492614780619556, -0.008729585827823507, -0.046532748885112496, 0.14875840148690875, 0.09352312146620653, 0.29735855136893535, -0.015517274543386991, 0.18684202023223476, -0.06481634005463173, -0.03674973096677489, 0.3476023560813626, -0.05739983859841202, 0.18173580471224565, 0.03757730237207074, -0.02263154900287946, 0.1036343373128234, 0.0359134986281886, 0.05407832097092134, -0.10268168440489649, 0.2018219572942375, -0.06157807256088817, 0.15228158419538745, 0.036675628142818044, 0.30060743133552126, 0.0837049342233464, 0.5010111039243197, -0.0760546899505576, 0.06069512052464901, -0.05497586508560365, 0.203312286957697, 0.08781662674208826, 0.162314112030638, -0.09579247659624089, 0.22554140658511812, 0.07849901115152734, 0.08506569421972349, -0.06967151512194432, -0.06835724601393506, -0.06930207559859008, -0.004303676599351655, 0.014045249802467765, 0.14061369155109738, 0.3376488379261523, 0.07939544559877425, 0.07099052074542715, 0.17026553243090597, 0.07388525224300342, -0.06306534307202045, 0.07939903649559607, 0.07526337861502826, -0.04715520831971416, 0.2833121135752105, 0.23612297850003422, 0.18562359012375643, 0.003985729620965087, 0.09159111881203386, -0.03458317655203664, -0.03238091765296126, 0.3093527743109685, -0.04732759289718383, -0.016369411351523734, -0.08483871757742865, 0.03458358889798199, -0.03211542527979809, 0.31797068297847864, 0.032289265545700066, 0.24079821267735896, 0.15615889157481064, 0.1940573210980554, 0.13287567188575355, 0.12931313748364984, 0.08544642990367322, 0.011356095959783598, -0.0599268659455317, 0.12268379107276908, 0.09908035899760653, -0.11632047835893564, 0.023912858314890387, 0.08758476153443072, 0.1278641927424443, 0.03017340425369426, 0.09230994601848505, 0.08974548542427858, 0.04534138577025523, 0.050217798172221405, 0.011914980357398002, -0.05920298302253388, -0.11614346470535436, 0.1433566727473701, 0.1086274574037055, 0.10778501549145086, -0.0397210559616775, -0.04404119480997583, -0.002510125755831213, -0.01647004552538929, -0.02024361915956696, -0.060078124201570625, -0.007790650207931262, -0.0020093273934838314, -0.027793536957622277, 0.08894808970337584, 0.09109960270552149, 0.1007114397221479, 0.0404935933001465, -0.009836583106118454, -0.030078016347181283, 0.2057679502805863, -0.024033076600698897, 0.02396800063370829, -0.10257890781703409, -0.051981598025386475, -0.02189115268841411, 0.16347547637143364, 0.01792906742598277, -0.058945848912135904, -0.10848272367737326, -0.002590504903137496, -0.0741256089690226, 0.19998461733489314, 0.19772423639730208, 0.014089355452086755, 0.09342318973285635, 0.0022463753499228425, -0.049191701005810426, -0.11242452119633248, -0.06908736950501804, 0.07734400968029456, -0.032277142554981875, 0.15999844872079125, -0.009724478830813298, 0.0047149799663706825, 0.14994503382777807, 0.11836699952227132, 0.14284434273599725, -0.06628939324755415, 0.15486107714416525, 0.013837087842846022, 0.21118239488377102, 0.08107170657575338, 0.03714326710394128, -0.007863675031431944, 0.17361862820275503, 0.13424030088869915, 0.11958158108040892, -0.029649028920953807, 0.0035661072959468857, -0.023201565142533544, -0.06414163897277401, 0.3651826024420015, 0.15480707225269458, 0.05004208168599426, -0.12727242939384564, 0.016621298328044178, -0.06420787845201732, -0.06711081633530147, 0.21338936643410117, 0.02454137557909155, -0.003372976505330162, 0.0713370791272659, -0.04336184533855308, 0.13035425499768466, 0.06276025844582943, -0.043150597505197744, -0.02000140171666927, 0.029100096630075067, 0.06924860988115925, 0.011606515878769557, -0.02187674267151749, 0.00438982639228308, 0.050292215146509556, -0.0735710397807324, -0.023613095481527735, 0.03802784481254114, -0.011992250777598485, -0.019402447756235758, 0.07035502221355405, 0.17584286678138583, 0.09702398545149869, 0.03866367741114106, -0.06505823290321432, 0.03619127133106186, 0.30678191305391933, 0.09994650051451351, -0.10140577758327973, 0.029307799544107404, 0.005675793743508464, 0.23936436314322468, 0.0395886163507964, 0.13298803530593312, -0.018945333078293956, -0.03137569911469637, 0.026285775256223935, 0.20114346262495814, 0.019056735791750417, 0.10730543335702326, -0.025954217369453345, 0.0781548274213077, -0.005426921167494372, 0.007535710128747181, 0.025746151468654468, 0.11671629461911992, 0.21393781112914412, -0.04725152949927757, 0.107030367463994, -0.07360005215619524, 0.07880397884929291, -0.03231411283145774, 0.19057861147511285, 0.24851865757998504, 0.10701133724793996, 0.09780962304454105, -0.050219984057484825, 0.08045595183365238, 0.052145770751928555, 0.11353584428878388, -0.008292496735852, 0.16397602143403503, 0.05253973360372345, -0.06972729234526898, -0.03449934288126846, -0.019554526172895687, 0.048333737388045965, -0.0118733573904429, -0.1007774467032646, 0.1370402361587911, 0.09119213965150565, -0.04538593984782199, -0.01440862491288059, 0.008557620058411387, 0.06463016283369491, 0.31310908606580273, -0.00477009586263134, -0.0014016338342856664, 0.0698032195024825, 0.1079345407332704, 0.06987490021377765, 0.04424619290882993, -0.004271093959437599, 0.06305753678650429, 0.04992464115391075, -0.0348333833604705, 0.07851391109339381, 0.11798621399020129, 0.0003060422935252157, -0.0011290460378282508, 0.06533181865695972, 0.17408141147208622, -0.07917727168668656, 0.15592473953331648, 0.05987624377764307, -0.09365556945780079, 0.06905759398543007, -0.05933640567646795, 0.08329195884195069, -0.04839665093905156, 0.05106443455670017, -0.021009356112427352, 0.3149742733497638, 0.23102199782759958, 0.4296751957894405, -0.05173588147757071, 0.00977474303299527, 0.06655271122983591, -0.02166447330790215, 0.061796856431740696, -0.01972866563966242, -0.025642729068437405, 0.25633997040885537, -0.06470698817248946, 0.02741845718364469, 0.22072113370086152, 0.26757688277179026, 0.018795278055854812, -0.01671305569359034, 0.15381445837983596, 0.053268802829666256, 0.16309488584253548, 0.08440243561007518, -0.050129324332327294, 0.07272271243673109, -0.058859396851395115, 0.10516626000776685, -0.008001893646661753, -0.04320828799791828, 0.08705950799232837, 0.16133806646654597, 0.130046003389073, -0.028193134412367565, 0.15339534948603734, 0.08613844542096818, 0.07075968172111498, 0.05609165464674664, 0.035411815896435196, 0.16382502228004067, 0.18855540338982302, 0.06678457577391564, -0.037182654181461425, 0.0027633316743867625, 0.11186177133604391, -0.05822846806967327, -0.022930440602297843, 0.1627480686271665, -0.022868348669492573, -0.03535850960039736, 0.30575926214927457, -0.1089251367892746, 0.07513467607938834, 0.18337896244930135, 0.08644630648873707, -0.06101137129703535, 0.09275230316568, -0.05511873772741844, 0.07488123114376109, 0.19186285188543925, -0.03446844079451367, 0.15466265101838433, -0.07207539565958802, 0.05015289428014421, 0.1086603679449328, 0.05526724649191279, 0.13804195019182333, 0.023915581130655974, -0.0556452852160267, -0.009946362980899483, -0.08469287221405826, 0.1684863252215866, -0.07882600953945333, 0.0782914192097264, 0.17066719077059467, 0.026066636349281212, -0.049867932135127864, 0.01638038604297926, 0.010808311685885714, -0.028352015719877638, 0.16318765085375228, 0.18751970748143165, 0.1440193762207281, 0.07418766374681333, 0.1655334038351509, -0.05991319307263703, 0.0026018180169104896, -0.024624795613509838, 0.04046634604584234, -0.04429179455886805, -0.04919175563773025, -0.06921001079430866, 0.15920877709314685, 0.01717593242309473, 0.0371585400793666, 0.05271391763433302, 0.12493078087409736, 0.13645785225709706, 0.10455849651247368, -0.00045700942437562446, 0.19585070664163134, 0.09992620750227617, 0.08390578084160828, -0.07234734009357155, -0.038103529353950734, 0.0511808930175357, -0.07108143304736637, 0.0037362977796229005, 0.1625273473584447, 0.14150386126725256, 0.12396790946872757, -0.02522695446492166, 0.03681904126230759, 0.2297401192013723, 0.09394797973134633, -0.014680779242466625, 0.07316100768454184, 0.16620969959846935, 0.2240191118178958, 0.07369463006441776, -0.08950311073997225, 0.12405763323186042, 0.011638347520703066, -0.07151616005630783, 0.0366931468982494, 0.21679677908411077, -0.02578546413552494, 0.12684225680049127, 0.3820873464752058, -0.015537259771503288, 0.005136397542530893, -0.11486938495275473, 0.15650783136693083, 0.4603707172383661, 0.07247671821131721, 0.10034216474888386, -0.09665099708452703, 0.1906514992508443, 0.25587020059159593, 0.0787914025649178, 0.041886444045030224, 0.0938162086307468, -0.082056870909585, 0.0981361461508243, 0.18043675002904427, 0.3815280879620282, 0.14714715907594728, 0.04807976328395826, -0.09990160652607773, 0.0553896005541879, 0.22833445129524685, 0.030515778912903864, 0.024160553786731594, 0.09759027807174539, 0.203344909970632, -0.009366419828718291, -0.06505687270870875, 0.10578283119979222, 0.17445247456811253, 0.06244592565805597, -0.05002410746337284, 0.5375294437123987, 0.07936376941422905, 0.02638540885515882, -0.06780155876039873, 0.2731694969078277, 0.12656024078154943, -0.026080490548907584, 0.05880415533472938, -0.01761861716771672, 0.03356853771482426, 0.03452699878820343, 0.11388686280753739, 0.09524852679937036, 0.019405113597990308, 0.07911335948300284, 0.27483415592714444, 0.09625947038697026, 0.0755911178256031, 0.0001390076935739292, 0.06874221036454907, -0.028667343160315405, 0.09056192905207909, 0.1423833805950772, 0.001563485374083566, -0.003924135164835696, 0.23258527382374672, 0.11054885058257985, -0.04692308861102307, -0.03853262294498631, 0.07483995973293954, 0.11334480676998011, 0.10188431292957376, -0.004556083837120032, 0.19358476625557625, 0.017507347073636218, 0.029070383675463156, -0.04039322966090475, -0.07837382430968308, 0.5598736853721198, 0.06368023336087705, -0.028398713740779073, -0.03481195284480498, 0.18902459486881595, 0.10103922188824217, -0.03188463201787148, -0.05120212708035404, -0.0045485543339268296, 0.009085433127779504, 0.06921678240084253, -0.07803900194532934, 0.16170470615356286, -0.02879236659890882, 0.08746303882335975, 0.16740044403976534, -0.008313795359863794, -0.0024766630306062255, 0.11522022904373488, 0.00572433704896929, 0.22211791995367944, -0.11090858079896998, 0.24119094441291422, 0.09708702357282326, 0.03688428404701338, 0.042992347674248005, 0.34250566330239124, 0.13994794191307736, 0.24891341012780757, -0.10688689894994938, 0.006579642605431896, 0.03601050369834184, -0.013091631424627641, 0.0038178023720822386, -0.008776084351659523, 0.2176139640040652, 0.07147559336337106, -0.060611494790472654, -0.10243980274746853, -0.030181776069151966, 0.01855909143626595, 0.10907897752156584, -0.09989988623209375, 0.04801971645117505, -0.07423278121357303, 0.013643408249737733, 0.12709110116909378, 0.043879143656210345, -0.010513240764750197, -0.11166429591293721, 0.03852956649705877, -0.04828905240786571, 0.3804155718221718, 0.006551735243819646, -0.016317086379619716, 0.17806825990845845, 0.35935120956623356, 0.18182106802269024, 0.1449734220887334, 0.014645825576324649, 0.056975774050028606, -0.0056704157941673446, 0.005590658168662926, 0.08493110909316486, 0.06739860761677363, -0.03578926920144858, 0.029938058984633312, -0.007767665541857406, 0.20336635970420475, -0.02803756612170681, 0.12179357994249024, 0.08494462594812009, 0.016563231241854437, 0.04048954378464226, 0.228304860361334, 0.0751276055887034, 0.012680324771476185, 0.03589411117925885, 0.01714430340737568, 0.09765829039000173, 0.3185180097179391, -0.12966232357803487, 0.2695454330370616, 0.04468513933157337, 0.03574523255996694, 0.1512141845684679, -0.04088103962444575, 0.1762677540150208, -0.00676397519580079, 0.07791710592910453, 0.007967763576310944, 0.16820938421061993, 0.04531565850369906, 0.06319543582072998, -0.10842114766928802, 0.17029332891830867, 0.047730171970139804, 0.31189010569923914, 0.28796265496514045, -0.01279118810112961, 0.054840665925192794, 0.05751277658023722, 0.06554710218793756, 0.11628802524240794, -0.006697548490318915, -0.047199997018344736, 0.051150964070831556, 0.03201754515463166, 0.2436287766419198, 0.050834567624294114, -0.02581961680293454, -0.004530824435801558, -0.060806928338650326, -0.06629570974752787, 0.20672310558075555, 0.011639468152849202, 0.11867958839848129, -0.05106625757856085, 0.17719910647552706, -0.06060790676156662, 0.18199203628792077, 0.026895970889101478, 0.14617829576865557, 0.02201433658219959, 0.04608786942010365, 0.17867657181481672, -0.03514659222803433, -0.05511812859771965, -0.12646067555376084, 0.08196216580518793, -0.047147154064367806, 0.05098308549171682, 0.049625212720017076, 0.11236713712424085, 0.11110938256180536, 0.15932453783159561, -0.06139813891470923, 0.02173938861582413, 0.10444485293884403, 0.09887036789442652, -0.05607981343862592, 0.18467909398674348, 0.1009447202083015, 0.1465354208331063, -0.03340681833751689, 0.19954859759745555, 0.09774080974586724, 0.040211402061065736, -0.059353389851059916, 0.0807114764715777, 0.01586790586010466, 0.20844888702889292, -0.07607460730184579, -0.0054255211541990155, -0.06441877349980331, -0.012276477349927097, -0.04440721958240645, -0.018084530644464514, -0.041996347965112375, -0.03882061409886277, 0.047719930144606515, 0.004224009928369148, -0.1285817601098195, -0.0679593336241574, 0.17987064512691422, -0.09185219588437257, -0.10973155392319384, 0.09677064716919864, 0.008357340264814012, -0.07386528230608, 0.22702205880651366, 0.1791255224664393, 0.11451039635951493, -0.08324778034705861, 0.04332276556660656, 0.05505982108390224, -0.02223708222743715, -0.10904577563417304, 0.16089455022870766, 0.11007990299421702, -0.01779706466041425, 0.09639141271371976, -0.040306066605344915, 0.08092420627767845, 0.04889115409031727, -0.08247631493851013, -0.06358929481503567, 0.02979945527231113, 0.08691849633972831, 0.16570988269072984, -0.053857650195255194, 0.10404600379941897, -0.02302404784834408, 0.18881690715069077, 0.08820703752431355, -0.07702737141000637, 0.09440384785171993, 0.1240800506965341, 0.051952874415302455, 0.24244223553943256, 0.12764414651347586, -0.05021638063688934, -0.1397579707548679, -0.021627225499871207, 0.06771923449809772, 0.1940216238534581, 0.05390548579960218, 0.034852651539387734, -0.0002484490154813861, 0.07221969997962265, 0.10974780452577351, -0.02965607211376221, -0.09774871540421867, 0.21324544936700543, 0.011692228120383603, 0.06726821773771287, 0.11130651594193447, 0.097317919198152, 0.027052550008150475, 0.008685514113419031, 0.2004560307624789, 0.23188936525005832, 0.09337845872769426, 0.09445993283957174, 0.010651042991329211, 0.23156435731517722, 0.1047045407281939, 0.0006641526142130239, -0.011593583737808387, 0.06702152983594917, -0.0036061549906837654, 0.18875822017001223, 0.17912260582421297, -0.005515984781744459, -0.06516117888434579, 0.08720885452975813, -0.009710781037282002, 0.035769616538025455, -0.053366396713991626, -0.005995042963994012, 0.026250871986574283, 0.028894815875373788, -0.007465956314142194, 0.010832532399115807, 0.0439312769932121, -0.09705450085816585, 0.012259625785372794, 0.021865042715338946, 0.24972209487368913, -0.09337622796504816, -0.08653406230105012, 0.33937864205923135, 0.14798045768244816, 0.14903771385541315, -0.1208021444634366, 0.08120233978136265, 0.010593070683809035, 0.04465186680956515, 0.1352701271019844, 0.027962231134628264, -0.0175918477146619, 0.06580207828237145, -0.05669477831444097, 0.026713702133215392, -0.03618320786195993, 0.016579974038811278, -0.07991902560934884, 0.2473227172129157, 0.11958926437767914, -0.05801047078305143, -0.08967302046171283, 0.1258396451761713, 0.04122314119900339, -0.058241867908655834, 0.06656606221859707, 0.15425135401688334, -0.07761822019632163, -0.07240797817995531, 0.08861457983550264, 0.1597082765569667, 0.17376297670000876, 0.028646097813900886, -0.012151779658857258, -0.03498152263867394, 0.24209125662539527, -0.016548734747709924, -0.055901141545480204, 0.13647292255417787, 0.15576047943274465, 0.013379960634278144, 0.15249738903914867, 0.12915256080044024, 0.1817776008465441, 0.04022049823246729, -0.0869704459372786, 0.02838893958008447, -0.08238201190404228, 0.16560594377951937, -0.011770013513002523, 0.13113159124248652, 0.009328832847534184, 0.3589638677531305, 0.172206486163416, -0.04941196632106956, 0.005297644293789601, 0.057517556916145796, 0.04131702657450325, 0.1575826914306776, 0.047760831458156947, -0.046165407653534454, 0.30756636296768247, 0.022654212745872853, -0.09746706795724956, 0.051586624853945065, -0.009420182588532316, -0.03522609623924614, -0.04470249068861611, -0.12409900131635201, 0.06896696857069154, -0.023391299544197063, 0.05276276646205083, -0.06674987013246211, 0.13781342027949112, 0.01297571446310563, -0.005726141981978459, -0.03996428453017488, -0.019597870752147882, -0.07085215524605934, 0.08983600365903813, -0.07741677257259935, -0.060669373769374764, 0.270840218030723, 0.3148825126808026, 0.09285364342938715, 0.06810979262847265, -0.032523913520384994, -0.025442995157252925, 0.04706862497386399, 0.2759726791372765, -0.07855615033454487, 0.09158665403675197, 0.05855613908195532, -0.000144092353800215, 0.25844157165967935, 0.05369847819366479, 0.001166604085478036, 0.054744852173165555, 0.02772342113432961, -0.03326711298351976, 0.0611073276882866, 0.012046346509914346, 0.10412511714268186, -0.015289139650256516, 0.005633675819954574, -0.0395108205535722, 0.008531949169944838, 0.00980363568656397, 0.1628045421740614, -0.002639887589064505, -0.0012275343956444883, -0.06001305707439032, -0.11016534297401068, -0.010308738269518941, 0.1938854699898887, -0.025446570746235672, 0.13335618237308444, 0.07520922790587464, 0.21831426531213788, -0.08814094992389337, -0.04468865384361037, 0.03421238069853029, 0.2024249183605126, 0.020390695077342175, 0.05240448980479481, 0.22145980117265804, 0.31182250356460467, -0.06044930228789081, 0.07162650265945614, 0.05140779829226518, 0.13151890582567616, 0.19744429319858747, -0.04328674618933455, 0.07008815581369174, -0.046632338937537945, 0.27229929515494616, 0.14609210999640826, 0.09439814866326551, 0.03310318189981764, 0.038165120230717046, 0.15868606889727693, 0.0873522683335557, 0.4266317744128386, 0.3194784043458107, -0.13840986547207634, 0.2027207019839169, 0.13256369219792663, 0.04871355152038892, 0.06847877391579005, 0.026301046250435164, 0.02278677921842488, 0.1924492814292087, 0.10262952897256056, 0.06378162093113687, 0.3717165886515611, 0.08367984866941727, -0.11936141821246035, 0.13017261254223056, 0.07843452423379688, 0.3426476408279883, 0.18540929224881847, 0.2171551514570313, 0.1283490623699074, 0.21933096121645407, -0.04271263827274011, -0.038191803099506066, -0.042119074931437545, 0.0997430321650953, 0.010965802031642203, 0.1678746474623302, 0.13110158014620063, 0.09724848278341994, 0.004598074477603545, 0.003004408135201109, -0.019943640606591723, 0.15402503900994774, 0.04412781105647082, 0.03207424471216674, 0.1640362948035532, 0.07724872283566173, 0.17244226916410915, 0.22171222538542715, 0.052825088347439667, 0.004162061174990968, 0.16232100142497496, -0.018927035495155734, 0.29388935912760994, 0.020752247051380165, 0.048761927294984235, -0.06228339870019764, 0.009652750941170117, 0.0363925927251397, 0.16553799356044338, 0.015051086711716464, 0.05578763737399495, 0.06329317047910635, -0.009438630956594824, 0.04165753048912538, -0.09878584617789371, -0.09764547784526953, 0.08998795378689442, -0.07232695043720255, -0.019205232721735, -0.02282413739386751, 0.1053224928981297, 0.047181522160340675, 0.03380363610066653, 0.015759951632884666, 0.03217517445620963, 0.0589700480545802, -0.10002223181966007, 0.003941662750870125, -0.024101981337829148, 0.05822327344309342, 0.19194422651991697, 0.4118028165150376, -0.08136551391629651, 0.07223631820173376, -0.012573850712957621, 0.029697704541095125, 0.14358966199371526, 0.03096506864578924, 0.08388106283284891, 0.06610662896158301, 0.18453440396436097, 0.13715416978433137, 0.22464649060911535, 0.14528054518101377, 0.020360680116452715, -0.02944336919753701, 0.29502145458967854, 0.046930174241824135, 0.04436778393624755, 0.25567825339824635, 0.04755376116625199, 0.07269036746195824, -0.12513076737978904, 0.26424285463655356, -0.03182752584333674, 0.13871515275196575, 0.12355831537350198, 0.07507171788149695]

print(collection.query(query_embeddings=[query_emb]))